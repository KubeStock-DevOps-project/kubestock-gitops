# =============================================================================
# Production Green Slot - Microservices Deployment
# =============================================================================
# Uses specific commit SHA tags (not latest)
# Update newTag with the actual short SHA from CI
# =============================================================================
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

namespace: kubestock-production

resources:
  - deployments.yaml

labels:
  - pairs:
      environment: production
      slot: green
    includeSelectors: true

# Image tags - USE SPECIFIC SHA TAGS, NOT LATEST
# Example: be6e547 (7-char short SHA from CI)
images:
  - name: 478468757808.dkr.ecr.ap-south-1.amazonaws.com/ms-product
    newTag: "20251204011859"  # Update with SHA from CI
  - name: 478468757808.dkr.ecr.ap-south-1.amazonaws.com/ms-inventory
    newTag: "20251204011909"  # Update with SHA from CI
  - name: 478468757808.dkr.ecr.ap-south-1.amazonaws.com/ms-supplier
    newTag: "20251204011915"  # Update with SHA from CI
  - name: 478468757808.dkr.ecr.ap-south-1.amazonaws.com/ms-order-management
    newTag: "20251204011924"  # Update with SHA from CI
  - name: 478468757808.dkr.ecr.ap-south-1.amazonaws.com/ms-identity
    newTag: "20251203175425"  # Update with SHA from CI
